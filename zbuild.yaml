---
default:
  - output/1.svg
  - rule: ex1
  - rule: ex2
  - rule: ex3_a
  - rule: ex3_b
  - rule: ex4_solve
  - rule: ex4_matrix
  - rule: ex4_sim
  - rule: ex5_solve
  - rule: ex5_sim1
  - rule: ex5_sim2

rules:
  # Typst
  typst:
    alias:
      input: ^(file).typ
      output: ^(file).pdf
    out: [$(output)]
    deps: [$(input)]
    exec:
      - - typst
        - compile
        - --root=.
        - $(input)
        - $(output)

  # Diagram
  diagram:
    alias:
      input: diagrams/^(file).dot
      output: output/^(file).svg
    out: [$(output)]
    deps: [$(input)]
    exec:
      - - dot
        - -Tsvg
        - $(input)
        - -o
        - $(output)

  # Exercise 1
  ex1:
    out:
      - output/1a (α=0.1, β=0.1).svg
      - output/1b (α=0.9, β=0.1).svg
      - output/1a (α=0.5, β=0.5).svg
      - output/1a (α=0.9, β=0.9).svg
    deps:
      - code/1.R
    exec:
      - - Rscript
        - code/1.R

  # Exercise 2
  ex2:
    out:
      - output/2-occur.csv
      - output/2-prob.csv
    deps:
      - code/2.R
    exec:
      - - Rscript
        - code/2.R

  # Exercise 3.a
  ex3_a:
    out:
      - output/3a-aloha10.svg
      - output/3a-aloha25.svg
    deps:
      - code/3a.R
    exec:
      - - Rscript
        - code/3a.R

  # Exercise 3.b
  ex3_b:
    out:
      - output/3b-aloha10.svg
      - output/3b-aloha25.svg
    deps:
      - code/3b.R
    exec:
      - - Rscript
        - code/3b.R

  # Exercise 4 solve
  ex4_solve:
    out:
      - output/4-solve.csv
    deps:
      - code/4-solve.R
    exec:
      - - Rscript
        - code/4-solve.R

  # Exercise 4 matrix
  ex4_matrix:
    out:
      - output/4-matrix.csv
    deps:
      - code/4-matrix.R
    exec:
      - - Rscript
        - code/4-matrix.R

  # Exercise 4 sim
  ex4_sim:
    out:
      - output/4-sim.csv
    deps:
      - code/4-sim.R
    exec:
      - - Rscript
        - code/4-sim.R

  # Exercise 5 solve
  ex5_solve:
    out:
      - output/5-solve.csv
    deps:
      - code/5-solve.R
    exec:
      - - Rscript
        - code/5-solve.R

  # Exercise 5 sim1
  ex5_sim1:
    out:
      - output/5-sim1.csv
    deps:
      - code/5-sim1.R
    exec:
      - - Rscript
        - code/5-sim1.R

  # Exercise 5 sim2
  ex5_sim2:
    out:
      - output/5-sim2.csv
    deps:
      - code/5-sim2.R
    exec:
      - - Rscript
        - code/5-sim2.R
